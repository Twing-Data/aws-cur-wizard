# Model YAML
# Reference documentation: https://docs.rilldata.com/reference/project-files/models

type: model
materialize: true

incremental: true
refresh:
  cron: "0 16 * * *"

partitions:
  glob:
    path: "{{ .env.cost_files_path }}"
    partition: directory

sql: |
  SELECT * FROM read_parquet('{{ .partition.uri }}/*.parquet') WHERE '{{ .partition.uri }}' IS NOT NULL
